<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4x4 Hindi Words Grid</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        .grid-container {
            width: 100%;
            max-width: 600px;
            margin: 20px auto;
            touch-action: none;
        }

        .grid-row {
            border: 1px solid #dee2e6;
            margin-bottom: 10px;
            padding: 2px;
            background-color: #f8f9fa;
            min-height: 100px;
            transition: background-color 0.3s;
            position: relative;
            display: flex;
        }

        .grid-item {
            border: 1px solid #dee2e6;
            padding: 20px;
            margin: 1%;
            cursor: move;
            user-select: none;
            -webkit-user-select: none;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: white;
            font-size: 24px;
            font-weight: bold;
            transition: background-color 0.3s;
            flex: 0 0 23%;
            touch-action: none;
        }

        .grid-item.correct {
            background-color: #98FB98;
        }

        .grid-item.selected {
            background-color: #e0e0e0;
        }

        .grid-item.disabled {
            cursor: not-allowed;
            opacity: 0.8;
        }

        .button-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            max-width: 600px;
            margin: 20px auto;
        }

        .custom-button {
            width: 40%;
        }
    </style>
</head>

<body>
    <div class="container">
        <h2 class="text-center mt-4">4x4 Hindi Words Grid</h2>
        <div class="grid-container" id="grid"></div>
        <div class="text-center mt-3 button-container">
            <button class="btn btn-primary custom-button" id="resetBtn">Reset/ नए शब्द</button>
            <button class="btn btn-info custom-button" data-toggle="modal" data-target="#howToPlayModal">
                How to Play/ कैसे खेलें
            </button>
        </div>

        <!-- Add Modal -->
        <div class="modal fade" id="howToPlayModal" tabindex="-1" role="dialog" aria-labelledby="howToPlayModalLabel"
            aria-hidden="true">
            <div class="modal-dialog" role="document">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="howToPlayModalLabel">How to Play</h5>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            <span aria-hidden="true">&times;</span>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div id="enD">
                            <p>
                                Letters of the 4 Hindi words given in this puzzle are shuffled at the start. Click any
                                of the letter to swap it with another letter by clicking the second box. When the
                                letters are in right order for any of the words then they will turn green and get
                                locked.
                            </p>
                        </div>
                        <div id="enH">
                            <p>
                                यहाँ चार अक्षर के चार शब्द दिये गए हैं लेकिन अक्षरों के क्रम बदल दिये गए हैं जिन्हें
                                आपको फिर से सही क्रम में जमाना है। आप किसी भी अक्षर को किसी दूसरे अक्षर के साथ बदलने के
                                लिए पहले अक्षर के डब्बे को क्लिक/टच करें फिर दूसरे अक्षर के डब्बे को क्लिक/टच करें। जब
                                कोई शब्द पूरा हो जाएगा तो उसका रंग हरा हो जाएगा और फिर उसके अक्षर स्थिर हो जाएंगे।
                            </p>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Add Bootstrap JavaScript and jQuery dependencies first -->
        <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
        <script src="wordbank.js"></script>
        <!-- Then add your game script -->
        <script>
            // Wait for jQuery to be loaded
            $(document).ready(function () {
                let alphabet = [];
                let selectedItem = null;
                let originalSequence = []

                function createGrid() {
                    alphabet = getRandomWords().join('').split('');
                    originalSequence = [...alphabet];
                    const grid = document.getElementById('grid');
                    grid.innerHTML = '';

                    for (let i = 0; i < 4; i++) {
                        const row = document.createElement('div');
                        row.className = 'grid-row';

                        for (let j = 0; j < 4; j++) {
                            const item = document.createElement('div');
                            item.className = 'grid-item';
                            item.textContent = alphabet[i * 4 + j];
                            item.addEventListener('click', handleItemClick);
                            item.addEventListener('touchstart', handleTouchStart, { passive: false });
                            row.appendChild(item);
                        }
                        grid.appendChild(row);
                    }
                }

                function shuffleArray(array) {
                    for (let i = array.length - 1; i > 0; i--) {
                        const j = Math.floor(Math.random() * (i + 1));
                        [array[i], array[j]] = [array[j], array[i]];
                    }
                }

                function shuffleGrid() {
                    const items = Array.from(document.getElementsByClassName('grid-item'));
                    const values = items.map(item => item.textContent);
                    shuffleArray(values);
                    items.forEach((item, index) => {
                        item.textContent = values[index];
                        item.classList.remove('correct', 'disabled');
                    });
                }

                function handleItemClick(e) {
                    if (e.target.classList.contains('disabled')) return;

                    if (!selectedItem) {
                        selectedItem = e.target;
                        selectedItem.classList.add('selected');
                    } else {
                        swapItems(selectedItem, e.target);
                        selectedItem.classList.remove('selected');
                        selectedItem = null;
                        checkRows();
                    }
                }

                function handleTouchStart(e) {
                    e.preventDefault();
                    handleItemClick(e);
                }

                function swapItems(item1, item2) {
                    const temp = item1.textContent;
                    item1.textContent = item2.textContent;
                    item2.textContent = temp;
                }

                function checkRows() {
                    const rows = document.getElementsByClassName('grid-row');

                    Array.from(rows).forEach(row => {
                        const items = Array.from(row.getElementsByClassName('grid-item'));
                        const values = items.map(item => item.textContent);

                        for (let i = 0; i <= 12; i += 4) {
                            const sequence = originalSequence.slice(i, i + 4).join('');
                            if (values.join('') === sequence) {
                                items.forEach(item => {
                                    item.classList.add('correct', 'disabled');
                                });
                                break;
                            }
                        }
                    });
                }

                $('#resetBtn').click(function () {
                    //alphabet = getRandomWords().join('').split('');
                    //shuffleGrid();

                    const oldGrid = document.getElementById('grid');
                    const newGrid = document.createElement('div');
                    newGrid.id = 'grid';
                    newGrid.classList.add('grid-container');
                    oldGrid.parentNode.replaceChild(newGrid, oldGrid);
                    grid = newGrid;


                    selectedItem = null;
                    createGrid();
                    shuffleGrid();
                });

                // Initialize the grid
                createGrid();
                shuffleGrid();
            });
        </script>
</body>

</html>